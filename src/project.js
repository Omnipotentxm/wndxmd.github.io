window.__require=function c(o,t,e){function r(n,h){if(!t[n]){if(!o[n]){var s=n.split("/");if(s=s[s.length-1],!o[s]){var a="function"==typeof __require&&__require;if(!h&&a)return a(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+n+"'")}n=s}var l=t[n]={exports:{}};o[n][0].call(l.exports,function(c){return r(o[n][1][c]||c)},l,l.exports,c,o,t,e)}return t[n].exports}for(var i="function"==typeof __require&&__require,n=0;n<e.length;n++)r(e[n]);return r}({game:[function(c,o,t){"use strict";cc._RF.push(o,"a7eb84Wyc5HU4+VAaLpb3nM","game"),cc.Class({extends:cc.Component,properties:{block:cc.Node,blockBg:cc.Node,scoreNode:cc.Node,hpBg:cc.Node},dfs:function(c){this.check.push(c.pos);for(var o=c.pos%10,t=(c.pos-o)/10,e=[1,0,-1,0,1],r=0;r<4;r++){var i=o+e[r+1],n=t+e[r],h=this.map[10*n+i];h&&(h.num==c.num&&this.check.indexOf(h.pos)<0&&this.dfs(h))}},destroyBlock:function(c,o){var t=this,e=!0,r=!1,i=void 0;try{for(var n,h=function(){var e=n.value,r=t.map[e];r.runAction(cc.sequence(cc.spawn(cc.fadeOut(.2),cc.moveTo(.2,c,o)),cc.callFunc(function(){r.destroy()}))),delete t.map[e]},s=this.check[Symbol.iterator]();!(e=(n=s.next()).done);e=!0)h()}catch(c){r=!0,i=c}finally{try{e||null==s.return||s.return()}finally{if(r)throw i}}setTimeout(function(){t.downBlock()},200)},downBlock:function(){for(var c=this,o=0;o<5;o++)for(var t=4;t>=0;t--){var e=10*o+t;if(!this.map[e])for(var r=t-1;r>=0;r--){var i=10*o+r,n=this.map[i];if(n){n.runAction(cc.moveTo(.1*(t-r),n.x,200-100*t)),this.map[e]=n,n.pos=e,delete this.map[i];break}}}setTimeout(function(){c.addBlock()},400)},addBlock:function(){for(var c=this,o=0;o<5;o++)for(var t=0;t<5;t++){var e=10*o+t;this.map[e]||this.createBolck(o,t)}setTimeout(function(){c.checkAll()},200)},createBolck:function(c,o){var t=this,e=Math.floor(5*Math.random()+1),r=cc.instantiate(this.block);this.blockBg.addChild(r),r.x=100*c-200,r.y=200-100*o,r.color=this.getColor(e),r.runAction(cc.scaleBy(.2,2)),this.map[10*c+o]=r,r.pos=10*c+o,r.num=e;var i=r.getChildByName("label").getComponent(cc.Label);i.string=e,r.on(cc.Node.EventType.TOUCH_START,function(){if(t.hp>=1){var c=t.hpBg,o="hp"+t.hp;c.getChildByName(o).active=!1,cc.log(o),t.hp--}r.num++,r.color=t.getColor(r.num),i.string=r.num;var e=r.x,n=r.y;t.checkBlock(e,n,r),cc.log(r)})},getColor:function(c){return 1==c?cc.color(238,228,218,255):2==c?cc.color(236,219,189,255):3==c?cc.color(242,177,123,255):4==c?cc.color(246,145,91,255):5==c?cc.color(244,117,85,255):6==c?cc.color(243,81,43,255):7==c?cc.color(236,205,112,255):8==c?cc.color(229,208,80,255):9==c?cc.color(206,162,11,255):c>9?cc.color(244,117,85,255):void 0},checkBlock:function(c,o,t){if(this.check=[],this.dfs(t),cc.log(this.check),this.check.length>=3){if(this.hp<5){this.hp++;var e=this.hpBg,r="hp"+this.hp;e.getChildByName(r).active=!0,cc.log(r)}return this.score+=t.num*this.check.length,this.scoreNode.getComponent(cc.Label).string=this.score,this.destroyBlock(c,o),!0}return!1},checkAll:function(){for(var c=0;c<5;c++)for(var o=0;o<5;o++){var t=10*c+o,e=this.map[t],r=e.x,i=e.y;if(1==this.checkBlock(r,i,e))return}},start:function(){this.map={},this.check=[],this.hp=5,this.score=0;for(var c=0;c<5;c++)for(var o=0;o<5;o++)this.createBolck(c,o);this.checkAll()}}),cc._RF.pop()},{}]},{},["game"]);